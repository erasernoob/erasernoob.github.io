<!DOCTYPE html>
<html lang="en" dir="auto">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="noindex, nofollow">
<title>初识Spring | xingpiaoliang&#39;s</title>
<meta name="keywords" content="原理">
<meta name="description" content="Spring
背景：现代软件开发中，各个模块依赖程度太高，高耦合度带来的是很致命的问题，需要将各个模块进行解耦。IOC是Inversion of Control的缩写，”控制反转“。将复杂系统分解成相互合作的对象，**将接口的实现类交给容器，由容器给予我们相对应的实现类。**高内聚，低耦合。
IOC容器基础
有一个Spring IOC容器实例化，组装管理的对象就称作为Bean。实际上就是编写配置文件，让IOC容器代理通过反射机制创建一个新的对象，而不是直接new出一个新的对象。需要注意的是，在配置文件中的每一个Bean都对应了一个单独的对象，当多次调用同一个name的Bean时，得到的都是同一个对象。默认为单例模式。
可以通过修改成为从 （原型模式）。
&lt;bean class=&#34;com.Student&#34; scope=&#34;prototype&#34;/&gt;
当bean的作用域为单例模式singleton时，是在容器一开始加载的时候对象就已经被创建了，之后取对象时只取得这一个，可以通过设置懒加载开启：取消一开始就加载创建对象。
&lt;bean class=&#34;com.Student&#34; scope=&#34;prototype&#34; lazy-init=&#34;true&#34;/&gt;
同时，需要维护Bean的加载顺序，对象的创建顺序：
&lt;bean class=&#34;com.Student&#34; scope=&#34;prototype&#34; depend-on=&#34;teacher&#34;/&gt;
&lt;bean class=&#34;com.Teacher name=&#34;teacher&#34; scope=&#34;prototype&#34;/&gt;
Core Container
Spring框架中最核心的一个模块。
依赖注入
当一个类内部需要依赖另一个类的创建时，Student中的Teacher成员变量，应将容器配置为在创建新的Student对象时，根据配置文件的需求，将需要的成员变量类注入到新的Student对象中。
向bean对象中添加相应的属性（对应的就是成员变量对象）。要使用依赖注入，必须在该类中添加set成员变量方法
&lt;bean class=&#34;com.Teacher name=&#34;teacher&#34; scope=&#34;prototype&#34;/&gt;
&lt;bean class=&#34;com.Student&#34;/&gt;
	&lt;property name=&#34;teacher&#34; ref=&#34;artTeacher&#34;/&gt; // ref ： 对另外一个对象的引用
    &lt;property name=&#34;sex&#34; value=“female&#34;&gt; // value成员变量为常量时
&lt;/bean&gt;
其实就是依靠容器，将具体实现类的信息全都交给配置文件，让容器动态的进行修改对象的各种属性,再对对象进行创建。
bean在创建对象时，默认的调用无参构造方法，当修改了默认的无参数构造方法时，需要在配置文件中手动的进行定义。
&lt;bean class=&#34;com.Student&#34;/&gt;
	&lt;constructor-arg name=&#34;teacher&#34; ref=&#34;artTeacher&#34;/&gt; // ref ： 对另外一个对象的引用
	&lt;constructor-arg name=&#34;sex&#34; value=“female&#34;/&gt; // value成员变量为常量时
&lt;/bean&gt;
通过这样设置构造函数的选择，将依赖注入的时间调整到了在构造对象调用构造方法的时候。
有时当name冲突时，需要特殊的具体的指定类型。
&lt;bean class=&#34;com.Student&#34;/&gt;
	&lt;property name=&#34;teacher&#34; ref=&#34;artTeacher&#34;/&gt; 
    &lt;property name=&#34;teacher&#34; value=“female&#34; type=&#34;String&#34;&gt;
&lt;/bean&gt;
同时如果需要注入集合类型对象，也可以加入相对应的初始值。
 &lt;bean name=&#34;student&#34; class=&#34;org.spring.entity.Student&#34;&gt;
        &lt;property name=&#34;list&#34;&gt;
            &lt;list&gt;
                &lt;value&gt;1&lt;/value&gt;
                &lt;value&gt;2&lt;/value&gt;
                &lt;value&gt;3&lt;/value&gt;
            &lt;/list&gt;
        &lt;/property&gt;
    &lt;/bean&gt;
所以，一共有两种方式来对对象进行依赖注入：

使用Set方法
使用对象的构造方法

自动装配
通过自动装配，让容器自动去寻找需要进行装配的值，省去了编写property的步骤。还是需要设定Setter方法。开启自动装配：
&lt;bean class=&#34;com.Student&#34; autowire=&#34;byType&#34;/&gt;
&lt;bean class=&#34;com.Teacher&#34;/&gt;
使用Byname属性。这里的name属性对应的是setter方法中的name。">
<meta name="author" content="">
<link rel="canonical" href="http://localhost:1313/posts/spring/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.4abf966a537fba7e797e3e35c6ed13648ff68827b513a68a07860ab8484a387d.css" integrity="sha256-Sr&#43;WalN/un55fj41xu0TZI/2iCe1E6aKB4YKuEhKOH0=" rel="preload stylesheet" as="style">
<link rel="icon" href="http://localhost:1313/favicon.ico">
<link rel="icon" type="image/png" sizes="16x16" href="http://localhost:1313/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="http://localhost:1313/favicon-32x32.png">
<link rel="apple-touch-icon" href="http://localhost:1313/apple-touch-icon.png">
<link rel="mask-icon" href="http://localhost:1313/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<link rel="alternate" hreflang="en" href="http://localhost:1313/posts/spring/">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --code-block-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
    <link rel="icon" href="/favicon.png" type="image/x-icon">
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="http://localhost:1313/" accesskey="h" title="xingpiaoliang&#39;s (Alt + H)">xingpiaoliang&#39;s</a>
            <div class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="http://localhost:1313/archives" title="archives">
                    <span>archives</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/categories/" title="categories">
                    <span>categories</span>
                </a>
            </li>
            <li>
                <a href="http://localhost:1313/tags/" title="tags">
                    <span>tags</span>
                </a>
            </li>
            <li>
                <a href="https://github.com/erasernoob" title="Github">
                    <span>Github</span>&nbsp;
                    <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
                        stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12">
                        <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"></path>
                        <path d="M15 3h6v6"></path>
                        <path d="M10 14L21 3"></path>
                    </svg>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title entry-hint-parent">
      初识Spring
    </h1>
    <div class="post-meta"><span title='2024-09-16 18:55:20 +0800 CST'>September 16, 2024</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;428 words

</div>
  </header> <div class="toc">
    <details >
        <summary accesskey="c" title="(Alt + C)">
            <span class="details">Table of Contents</span>
        </summary>

        <div class="inner"><ul>
                <li>
                    <a href="#spring" aria-label="Spring">Spring</a><ul>
                        
                <li>
                    <a href="#ioc%e5%ae%b9%e5%99%a8%e5%9f%ba%e7%a1%80" aria-label="IOC容器基础">IOC容器基础</a><ul>
                        
                <li>
                    <a href="#core-container" aria-label="Core Container">Core Container</a></li>
                <li>
                    <a href="#%e4%be%9d%e8%b5%96%e6%b3%a8%e5%85%a5" aria-label="依赖注入">依赖注入</a></li>
                <li>
                    <a href="#%e8%87%aa%e5%8a%a8%e8%a3%85%e9%85%8d" aria-label="自动装配">自动装配</a></li>
                <li>
                    <a href="#bean%e7%9a%84%e7%94%9f%e5%91%bd%e5%91%a8%e6%9c%9f%e4%b8%8e%e7%bb%a7%e6%89%bf" aria-label="Bean的生命周期与继承">Bean的生命周期与继承</a></li>
                <li>
                    <a href="#bean%e5%b7%a5%e5%8e%82%e6%a8%a1%e5%bc%8f" aria-label="Bean工厂模式">Bean工厂模式</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e6%b3%a8%e8%a7%a3%e5%bc%80%e5%8f%91" aria-label="使用注解开发">使用注解开发</a></li></ul>
                </li>
                <li>
                    <a href="#spring%e9%ab%98%e7%ba%a7%e7%89%b9%e6%80%a7" aria-label="Spring高级特性">Spring高级特性</a><ul>
                        
                <li>
                    <a href="#bean-aware" aria-label="Bean Aware">Bean Aware</a></li>
                <li>
                    <a href="#%e4%bb%bb%e5%8a%a1%e8%b0%83%e5%ba%a6" aria-label="任务调度">任务调度</a></li></ul>
                </li>
                <li>
                    <a href="#springel%e8%a1%a8%e8%be%be%e5%bc%8f" aria-label="SpringEL表达式">SpringEL表达式</a><ul>
                        
                <li>
                    <a href="#%e5%a4%96%e9%83%a8%e5%b1%9e%e6%80%a7%e7%9a%84%e6%b3%a8%e5%85%a5" aria-label="外部属性的注入">外部属性的注入</a></li></ul>
                </li>
                <li>
                    <a href="#aopaspect-oriented-programming" aria-label="AOP(Aspect Oriented Programming)">AOP(Aspect Oriented Programming)</a><ul>
                        
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8%e6%8e%a5%e5%8f%a3%e5%ae%9e%e7%8e%b0aop" aria-label="使用接口实现AOP">使用接口实现AOP</a></li></ul>
                </li>
                <li>
                    <a href="#%e6%95%b0%e6%8d%ae%e6%a1%86%e6%9e%b6%e7%9a%84%e6%95%b4%e5%90%88" aria-label="数据框架的整合">数据框架的整合</a><ul>
                        
                <li>
                    <a href="#%e6%95%b0%e6%8d%ae%e6%ba%90" aria-label="数据源">数据源</a></li>
                <li>
                    <a href="#%e6%95%b4%e5%90%88mybatis%e6%a1%86%e6%9e%b6" aria-label="整合Mybatis框架">整合Mybatis框架</a></li>
                <li>
                    <a href="#%e4%bd%bf%e7%94%a8hikaricp%e8%bf%9e%e6%8e%a5%e6%b1%a0" aria-label="使用HikariCP连接池">使用HikariCP连接池</a></li>
                <li>
                    <a href="#mybatis%e4%ba%8b%e5%8a%a1%e7%ae%a1%e7%90%86" aria-label="Mybatis事务管理">Mybatis事务管理</a></li>
                <li>
                    <a href="#spring%e4%ba%8b%e5%8a%a1%e7%ae%a1%e7%90%86" aria-label="Spring事务管理">Spring事务管理</a></li></ul>
                </li>
                <li>
                    <a href="#j-unit%e9%9b%86%e5%90%88%e6%b5%8b%e8%af%95" aria-label="J Unit集合测试">J Unit集合测试</a></li>
                <li>
                    <a href="#resource-and-autowired%e5%af%b9%e6%af%94" aria-label="@Resource and @autowired对比">@Resource and @autowired对比</a>
                </li>
            </ul>
            </li>
            </ul>
        </div>
    </details>
</div>

  <div class="post-content"><h1 id="spring">Spring<a hidden class="anchor" aria-hidden="true" href="#spring">#</a></h1>
<p>背景：现代软件开发中，各个模块依赖程度太高，高耦合度带来的是很致命的问题，需要将各个模块进行解耦。IOC是Inversion of Control的缩写，”控制反转“。将复杂系统分解成相互合作的对象，**将接口的实现类交给容器，由容器给予我们相对应的实现类。**高内聚，低耦合。</p>
<h2 id="ioc容器基础">IOC容器基础<a hidden class="anchor" aria-hidden="true" href="#ioc容器基础">#</a></h2>
<p>有一个Spring IOC容器实例化，组装管理的对象就称作为<strong>Bean</strong>。实际上就是编写配置文件，让IOC容器代理通过反射机制创建一个新的对象，而不是直接new出一个新的对象。需要注意的是，在配置文件中的每一个Bean<strong>都对应了一个单独的对象</strong>，当多次调用同一个name的Bean时，得到的都是同一个对象。<strong>默认为单例模式</strong>。</p>
<p>可以通过修改成为从 <strong>（原型模式）</strong>。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;com.Student&#34;</span> <span class="na">scope=</span><span class="s">&#34;prototype&#34;</span><span class="nt">/&gt;</span>
</span></span></code></pre></div><p>当bean的作用域为单例模式<strong>singleton</strong>时，是在容器一开始加载的时候对象就已经被创建了，之后取对象时只取得这一个，可以通过设置懒加载开启：取消一开始就加载创建对象。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;com.Student&#34;</span> <span class="na">scope=</span><span class="s">&#34;prototype&#34;</span> <span class="na">lazy-init=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
</span></span></code></pre></div><p>同时，需要维护Bean的加载顺序，对象的创建顺序：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;com.Student&#34;</span> <span class="na">scope=</span><span class="s">&#34;prototype&#34;</span> <span class="na">depend-on=</span><span class="s">&#34;teacher&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;com.Teacher name=&#34;</span><span class="err">teacher&#34;</span> <span class="na">scope=</span><span class="s">&#34;prototype&#34;</span><span class="nt">/&gt;</span>
</span></span></code></pre></div><h3 id="core-container">Core Container<a hidden class="anchor" aria-hidden="true" href="#core-container">#</a></h3>
<p>Spring框架中最核心的一个模块。</p>
<h3 id="依赖注入">依赖注入<a hidden class="anchor" aria-hidden="true" href="#依赖注入">#</a></h3>
<p>当一个类内部需要依赖另一个类的创建时，Student中的Teacher成员变量，应将容器配置为在创建新的Student对象时，根据配置文件的需求，<strong>将需要的成员变量类注入到新的Student对象中</strong>。</p>
<p>向bean对象中添加相应的属性（对应的就是成员变量对象）。<strong>要使用依赖注入，必须在该类中添加set成员变量方法</strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;com.Teacher name=&#34;</span><span class="err">teacher&#34;</span> <span class="na">scope=</span><span class="s">&#34;prototype&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;com.Student&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;teacher&#34;</span> <span class="na">ref=</span><span class="s">&#34;artTeacher&#34;</span><span class="nt">/&gt;</span> // ref ： 对另外一个对象的引用
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;sex&#34;</span> <span class="na">value=</span><span class="s">“female&#34;</span><span class="nt">&gt;</span> // value成员变量为常量时
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/bean&gt;</span>
</span></span></code></pre></div><p>其实就是依靠容器，将具体实现类的信息全都交给配置文件，让容器动态的进行修改对象的各种属性,再对对象进行创建。</p>
<p>bean在创建对象时，默认的调用无参构造方法，当修改了默认的无参数构造方法时，需要在配置文件中手动的进行定义。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;com.Student&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&#34;teacher&#34;</span> <span class="na">ref=</span><span class="s">&#34;artTeacher&#34;</span><span class="nt">/&gt;</span> // ref ： 对另外一个对象的引用
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;constructor-arg</span> <span class="na">name=</span><span class="s">&#34;sex&#34;</span> <span class="na">value=</span><span class="s">“female&#34;/</span><span class="nt">&gt;</span> // value成员变量为常量时
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/bean&gt;</span>
</span></span></code></pre></div><p>通过这样设置构造函数的选择，将依赖注入的时间调整到了在构造对象调用构造方法的时候。</p>
<p>有时当name冲突时，需要特殊的具体的指定类型。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;com.Student&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;teacher&#34;</span> <span class="na">ref=</span><span class="s">&#34;artTeacher&#34;</span><span class="nt">/&gt;</span> 
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;teacher&#34;</span> <span class="na">value=</span><span class="s">“female&#34;</span> <span class="na">type=</span><span class="s">&#34;String&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/bean&gt;</span>
</span></span></code></pre></div><p>同时如果需要注入集合类型对象，也可以加入相对应的初始值。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"> <span class="nt">&lt;bean</span> <span class="na">name=</span><span class="s">&#34;student&#34;</span> <span class="na">class=</span><span class="s">&#34;org.spring.entity.Student&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;list&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;list&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;value&gt;</span>1<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;value&gt;</span>2<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;value&gt;</span>3<span class="nt">&lt;/value&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/list&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/property&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/bean&gt;</span>
</span></span></code></pre></div><p>所以，一共有两种方式来对对象进行依赖注入：</p>
<ul>
<li>使用Set方法</li>
<li>使用对象的构造方法</li>
</ul>
<h3 id="自动装配">自动装配<a hidden class="anchor" aria-hidden="true" href="#自动装配">#</a></h3>
<p>通过自动装配，让容器自动去寻找需要进行装配的值，省去了编写<strong>property</strong>的步骤。还是需要设定Setter方法。开启自动装配：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;com.Student&#34;</span> <span class="na">autowire=</span><span class="s">&#34;byType&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;com.Teacher&#34;</span><span class="nt">/&gt;</span>
</span></span></code></pre></div><p>使用Byname属性。这里的name属性对应的是setter方法中的name。</p>
<p>同时设定setter方法的时候<code>setArt</code>,容器才能自动找到相对应的名字进行装配。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;bean</span> <span class="na">class=</span><span class="s">&#34;com.Student&#34;</span> <span class="na">autowire=</span><span class="s">&#34;byName&#34;</span>   <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;bean</span> <span class="na">name=</span><span class="s">&#34;art&#34;</span> <span class="na">class=</span><span class="s">&#34;com.Teacher&#34;</span><span class="nt">/&gt;</span>
</span></span></code></pre></div><p>构造方法的自动装配（这种情况默认也是byType寻找的）。<code>autowire=&quot;constructor&quot;</code></p>
<p>自动装配时，bean存在一个候选名单，当byType出现冲突的时候，也就是存在两个候选Bean的时候，可以设置<code>autowire-candidate=false</code>,将该对应的bean剔除候选名单。<code>primary=&quot;true&quot;</code>,设置bean的优先级。</p>
<h3 id="bean的生命周期与继承">Bean的生命周期与继承<a hidden class="anchor" aria-hidden="true" href="#bean的生命周期与继承">#</a></h3>
<p><code>init-method destory-method</code>两种属性设置Bean默认的初始化方法，和销毁方法。后者方法，当调用<code>context.close()</code>时，会调用<code>destory-method</code>,并且其中为单例模式的bean也会被销毁，且执行销毁方法。出于原型模式的bean，并不会执行其销毁方法。</p>
<p>Bean之间的继承关系是Bean之间的属性继承。<code>parent</code>同时可以在最外层的beans标签中添加全局的默认属性。</p>
<h3 id="bean工厂模式">Bean工厂模式<a hidden class="anchor" aria-hidden="true" href="#bean工厂模式">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;bean</span> <span class="na">factory-bean=</span><span class="s">&#34;studentFactory&#34;</span> <span class="na">factory-method=</span><span class="s">&#34;getStudent&#34;</span><span class="nt">/&gt;</span>
</span></span></code></pre></div><p>使用工厂bean之后不需要在提供指定的class了。如果想要获取工厂bean提供给我们的bean也就是学生只需要：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Student</span><span class="w"> </span><span class="n">bean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Student</span><span class="p">)</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">getBen</span><span class="p">(</span><span class="s">&#34;studentFactory&#34;</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><p>如果想要获取到工厂类的实例：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Student</span><span class="w"> </span><span class="n">bean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Student</span><span class="p">)</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="na">getBen</span><span class="p">(</span><span class="s">&#34;&amp;studentFactory&#34;</span><span class="p">);</span><span class="w">
</span></span></span></code></pre></div><h3 id="使用注解开发">使用注解开发<a hidden class="anchor" aria-hidden="true" href="#使用注解开发">#</a></h3>
<p>使用注解完成对配置文件的配置。使用注解开发，现在就只需要创建一个配置类就行了（等同于配置文件的开头的配置文件模板）。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Import</span><span class="p">(</span><span class="n">LBWconfiguration</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w"> </span><span class="c1">// 通过import引入其他的配置类</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nf">MainConfiguration</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Bean</span><span class="p">(</span><span class="s">&#34;test&#34;</span><span class="p">)</span><span class="w"> </span><span class="c1">// name </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Lazy</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Scope</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Student</span><span class="w"> </span><span class="nf">Student</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Student</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><ul>
<li>
<p><code>@autowire</code>采用默认的byType的方式来进行匹配。<code>@Qualifier</code>用来使用byName模式来进行自动装配。</p>
</li>
<li>
<p><code>@PostConsturct</code> <code>@PreDestroy</code> === <code>init-method</code> <code>destroy-method</code></p>
</li>
<li>
<p><code>@Resource</code> 默认的是使用<code>Byname</code>的形式来进行匹配 ，找不到则使用<code>byType``@AutoWire</code>则是只能使用byType方式匹配。同时后者不建议加在字段之上，前者可以加在字段上。</p>
</li>
<li>
<p><code>@Component</code>直接加在响应的类之上，将类变成Bean<code>@ComponentScan</code>手动告诉配置类需要进行扫描的包名。</p>
</li>
<li>
<p>注意：注解中的数组表示{}</p>
</li>
</ul>
<p>加上注解之后，默认的会赋予Bean名字（首字母小写）</p>
<h2 id="spring高级特性">Spring高级特性<a hidden class="anchor" aria-hidden="true" href="#spring高级特性">#</a></h2>
<h3 id="bean-aware">Bean Aware<a hidden class="anchor" aria-hidden="true" href="#bean-aware">#</a></h3>
<p>一种接口，Aware，就是可以在创建对象之前，先“aware&quot;到加载阶段的东西，可以提前获得类的各种属性。</p>
<h3 id="任务调度">任务调度<a hidden class="anchor" aria-hidden="true" href="#任务调度">#</a></h3>
<p>spring所提供的能够简化类似于多线程工作环境下的任务处理。</p>
<ul>
<li><code>EnableSync</code> <code>EnableAsync</code>开启异步同步特性。 Example：异步和同步的实现：<code>Sync</code> <code>Async</code>
<ul>
<li><code>@Scheduled</code>开启定时任务</li>
</ul>
</li>
</ul>
<h2 id="springel表达式">SpringEL表达式<a hidden class="anchor" aria-hidden="true" href="#springel表达式">#</a></h2>
<h3 id="外部属性的注入">外部属性的注入<a hidden class="anchor" aria-hidden="true" href="#外部属性的注入">#</a></h3>
<p>从外部的properties配置文件中得到属性。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w"> </span><span class="n">ExpressionParser</span><span class="w"> </span><span class="n">parser</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SpelExpressionParser</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">Expression</span><span class="w"> </span><span class="n">exp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parser</span><span class="p">.</span><span class="na">parseExpression</span><span class="p">(</span><span class="s">&#34;&#39;Hello World&#39;.length&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">exp</span><span class="p">.</span><span class="na">getValue</span><span class="p">());</span><span class="w">
</span></span></span></code></pre></div><p>其实就是将java表达式作为字符串进入表达式进行执行，同时也可以接受对象，并对对象的属性进行设置或者获取 ，其中也可以写类似与python，C++等语言的对集合元素的控制方式，增大了对集合元素代码的掌控.</p>
<h2 id="aopaspect-oriented-programming">AOP(Aspect Oriented Programming)<a hidden class="anchor" aria-hidden="true" href="#aopaspect-oriented-programming">#</a></h2>
<p>不修改源代码的情况下，给添加更多的内容。将整个类给切开，在需要的地方作为切入点，从切入点加入需要加入的东西。AOP是基于动态代理来实现的，所以经过切入之后，现在的类已经不是之前的类了。</p>
<h3 id="使用接口实现aop">使用接口实现AOP<a hidden class="anchor" aria-hidden="true" href="#使用接口实现aop">#</a></h3>
<p>与配置文件大同小异，需要切入类需要实现对应的接口，来调整切入的时间。</p>
<p><strong>通过给切片方法添加JoinPoint的参数获取原来类的方法的参数</strong></p>
<ul>
<li><code>@Before</code> <code>@After</code> <code>@Around</code></li>
<li>around方式，将方法给整体给进行代理。</li>
</ul>
<h2 id="数据框架的整合">数据框架的整合<a hidden class="anchor" aria-hidden="true" href="#数据框架的整合">#</a></h2>
<p>将Spring和<code>Mybatis</code>框架进行整合。</p>
<h3 id="数据源">数据源<a hidden class="anchor" aria-hidden="true" href="#数据源">#</a></h3>
<p><code>Mybatis</code>并不是通过<code>DriverManager</code>的方法来获取连接。而是使用<code>DataSource</code>的实现类来进行获取的。和数据库连接是一个极其耗费资源的操作，<code>DataSource</code>中有很多个<code>Connection</code>对象，也就形成了一个连接池，其中包含了很多个<code>Connection</code>对象，想要进行连接的时候，直接返回现成的连接对象。<strong>连接池</strong>，池化的数据源，内部是根据栈的数据结构来进行实现的</p>
<h3 id="整合mybatis框架">整合Mybatis框架<a hidden class="anchor" aria-hidden="true" href="#整合mybatis框架">#</a></h3>
<p>需要配置文件的方法，省去了自己配写工具类。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w"> </span><span class="kd">public</span><span class="w"> </span><span class="n">SqlSessionTemplate</span><span class="w"> </span><span class="nf">sqlSessionTemplate</span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       	</span><span class="n">SqlSessionFactory</span><span class="w"> </span><span class="n">factory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> 				
</span></span></span><span class="line"><span class="cl"><span class="w">       	</span><span class="n">SqlSessionFactoryBuilder</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="p">.</span><span class="na">build</span><span class="p">(</span><span class="n">Resources</span><span class="p">.</span><span class="na">getResourceAsStream</span><span class="p">(</span><span class="s">&#34;mybatis-config.xml&#34;</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SqlSessionTemplate</span><span class="p">(</span><span class="n">factory</span><span class="p">);</span><span class="w"> </span><span class="c1">// 返回一个Sqlsesion模板交给Spring进行管理</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>在配置中自己创建一<code>DataSource</code>并且创建<code>Bean</code>进行管理，提供<code>SqlSessionFactoryBean</code>,此时数据库就可以正常根据<code>mapper</code>来运行了。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@MapperScan</span><span class="p">(</span><span class="s">&#34;org.spring.mapper&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MainConfiguration</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Bean</span><span class="w"> </span><span class="c1">// 新建一个Bean，方便后续替换 这个默认的数据源是由JDBC官方默认提供的，还有着很多的优秀的数据源</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">DataSource</span><span class="w"> </span><span class="nf">dataSource</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">PooledDataSource</span><span class="p">(</span><span class="s">&#34;com.mysql.cj.jdbc.Driver&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;jdbc:mysql://localhost:3306/study&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;root&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34; &#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Bean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">SqlSessionFactoryBean</span><span class="w"> </span><span class="nf">sqlSessionFactoryBean</span><span class="p">(</span><span class="n">DataSource</span><span class="w"> </span><span class="n">dataSource</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">SqlSessionFactoryBean</span><span class="w"> </span><span class="n">sqlSessionFactoryBean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SqlSessionFactoryBean</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">sqlSessionFactoryBean</span><span class="p">.</span><span class="na">setDataSource</span><span class="p">(</span><span class="n">dataSource</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">sqlSessionFactoryBean</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="使用hikaricp连接池">使用HikariCP连接池<a hidden class="anchor" aria-hidden="true" href="#使用hikaricp连接池">#</a></h3>
<p>还有着很多的不同的数据源实现。使用方法原理都是相通的</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w"> </span><span class="nd">@Bean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">DataSource</span><span class="w"> </span><span class="nf">dataSource</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">HikariDataSource</span><span class="w"> </span><span class="n">dataSource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HikariDataSource</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">dataSource</span><span class="p">.</span><span class="na">setDriverClassName</span><span class="p">(</span><span class="s">&#34;com.mysql.jdbc.Driver&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">dataSource</span><span class="p">.</span><span class="na">setJdbcUrl</span><span class="p">(</span><span class="s">&#34;jdbc:mysql://localhost:3306/study&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">dataSource</span><span class="p">.</span><span class="na">setUsername</span><span class="p">(</span><span class="s">&#34;root&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">dataSource</span><span class="p">.</span><span class="na">setPassword</span><span class="p">(</span><span class="s">&#34; &#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">dataSource</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Bean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">SqlSessionFactoryBean</span><span class="w"> </span><span class="nf">sqlSessionFactoryBean</span><span class="p">(</span><span class="n">DataSource</span><span class="w"> </span><span class="n">dataSource</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">SqlSessionFactoryBean</span><span class="w"> </span><span class="n">sqlSessionFactoryBean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SqlSessionFactoryBean</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">sqlSessionFactoryBean</span><span class="p">.</span><span class="na">setDataSource</span><span class="p">(</span><span class="n">dataSource</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">sqlSessionFactoryBean</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="mybatis事务管理">Mybatis事务管理<a hidden class="anchor" aria-hidden="true" href="#mybatis事务管理">#</a></h3>
<ul>
<li>(Atomicity):事务是一个原子操作，应该保证动作全部完成或者完全不起作用。</li>
<li>(Consistency):一致性不能一个部分成功或者一个部分失败。</li>
<li>(Isolation)：在很多个事务处理相同的数据的时候，每个事务应该和其他事务隔离开了，每个人看到的结果应该都是独立的。</li>
<li>(Durability):持久性</li>
</ul>
<p>并发执行下，没有并发控制，会出现的三种情况：</p>
<ul>
<li>脏读：读取到了一个事务提交过后的数据，但最后该事务又进行了回滚的操作，读取到了没有意义的数据。</li>
<li>虚读（不可重复读）：是在某一个事务对数据进行修改之前读取一次，修改完毕之后再次读取一次，导致两次读取的数据不一样的情况。</li>
<li>幻读：由于在该事务执行过程中，无法感知到其他事务强行插入删除数据记录，导致数据整个表的数据记录数量前后不一致的情况。</li>
</ul>
<p><strong>虚读和幻读：虚读是对某个单个数据前后读取不一致，幻读则是对整个表的记录数量前后读取不一致</strong>。</p>
<p><img alt="nHfV8R1ZUybTSd2.png (342×202)" loading="lazy" src="https://image.itbaima.cn/markdown/2022/12/17/nHfV8R1ZUybTSd2.png"></p>
<p>事务的操作分为：创建，提交，回滚，关闭。而这些四个操作则被Mybatis抽象为一个接口 <code>Transaction</code>。Mybatis对事务的管理有着两种实现方式，也就是两种种不同的实现这个接口的方式：</p>
<ul>
<li><code>JDBC</code>使用JDBC的事务管理机制，利用对应的数据库（数据源）驱动生成的对象<code>connection</code></li>
<li><code>Manage</code>管理机制，将事务管理交给类似于Spring的框架。</li>
</ul>
<h3 id="spring事务管理">Spring事务管理<a hidden class="anchor" aria-hidden="true" href="#spring事务管理">#</a></h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Component</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">TestServiceImpl</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">TestService</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Autowired</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">TestMapper</span><span class="w"> </span><span class="n">mapper</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Transactional</span><span class="w"> </span><span class="c1">// 将该操作作为事务进行执行</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">mapper</span><span class="p">.</span><span class="na">insertStudent</span><span class="p">(</span><span class="s">&#34;小红&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;男&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">mapper</span><span class="p">.</span><span class="na">insertStudent</span><span class="p">(</span><span class="s">&#34;小君&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;女&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="j-unit集合测试">J Unit集合测试<a hidden class="anchor" aria-hidden="true" href="#j-unit集合测试">#</a></h2>
<p>Spring框架提供了一个Test模块，可以自动继承JUnit进行测试。依赖：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">  <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.junit.jupiter<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>junit-jupiter<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;version&gt;</span>5.11.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-test<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;version&gt;</span>6.1.12<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@ExtendWith</span><span class="p">(</span><span class="n">SpringExtension</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@ContextConfiguration</span><span class="p">(</span><span class="n">classes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MainConfiguration</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MainTest</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Autowired</span><span class="w"> </span><span class="c1">// </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">TestService</span><span class="w"> </span><span class="n">testService</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">test</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">testService</span><span class="p">.</span><span class="na">test</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="resource-and-autowired对比"><code>@Resource</code> and <code>@autowired</code>对比<a hidden class="anchor" aria-hidden="true" href="#resource-and-autowired对比">#</a></h2>
<p><code>@Resource</code>是<code>Java EE</code>中的一个注解，<strong>根据名字自动进行装配依赖</strong>，首先根据类名字寻找有无管理的依赖来进行注入，如果没有再根据类型来选择依赖进行注入。</p>
<p><code>@autowired</code>则是Spring中提供的根据类型，进行注入依赖的注解。显得更加灵活</p>
<p><code>Interceptor</code>中依赖注入问题，GPT原文如下：</p>
<blockquote>
<ul>
<li><strong><code>HandlerInterceptor</code> 的生命周期问题：</strong> <code>HandlerInterceptor</code> 是用于拦截器链的对象。Spring Web 配置中通常会手动注册拦截器，而拦截器实例的管理方式和普通的 Spring Bean 不完全相同。<strong>具体来说，<code>HandlerInterceptor</code> 的实例是由 Spring 在请求处理时创建的，而不是由 Spring 容器管理的普通 Bean</strong>。这样，当你尝试在 <code>Interceptor</code> 中使用 <code>@Resource</code> 注入时，Spring 可能不会正确地完成依赖注入，尤其是在没有显式注册拦截器 Bean 的情况下。</li>
<li><strong>构造函数注入 vs 字段注入：</strong> 如果你用 <code>@Component</code> 注册了 <code>LoginInterceptor</code>，Spring 会创建一个默认的无参数构造函数实例，但它并不总是正确地将 <code>@Resource</code> 或 <code>@Autowired</code> 注解的依赖注入到拦截器中，特别是当拦截器是在 Web 配置中手动注册时**。通常，Spring 无法通过字段注入来处理 <code>Interceptor</code>，因为它没有机会管理依赖的生命周期。**</li>
</ul>
</blockquote>
<p>所以，因为<code>interceptor</code>应该算是一个特殊的管理的Bean，通常不使用字段注入，而是使用构造函数注入，且在配置类中进行注入所需依赖之后，传递给<code>interceptor</code>。</p>


  </div>
  

  


  <footer class="post-footer">
    <ul class="post-tags">
      <li><a href="http://localhost:1313/tags/%E5%8E%9F%E7%90%86/">原理</a></li>
    </ul>

<ul class="share-buttons">
</ul>

  </footer>
</article>
    </main>
    
<footer class="footer">
        <span>&copy; 2025 <a href="http://localhost:1313/">xingpiaoliang&#39;s</a></span> · 

    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://github.com/adityatelange/hugo-PaperMod/" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
</body>

</html>
