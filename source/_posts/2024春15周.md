---
title: 2024春15周
date: 2024-06-17 20:00:45
tags: 学习记录
---



### 前言

这一周来看过得比较匆匆忙忙，看着上周的记录，原来高考完也只是两周之前的事情，时间也没有我想的那么快吗。这周是虎头蛇尾的一周，CSAPP没有怎么向前推进，CS106x在我印象中好像根本就没有触碰过，只是进度推的也很慢，好像是看完了教授在讲的两节图论课，和课堂内讲的有些重复，甚至有些浅了。二项树的assignment也还没向前推进，搁置了一周吧。为什么对上周好像显得有一点模糊可能是因为，我正处在16周的星期一写着15周的记录的前言，星期六也是结束了匆匆忙忙将将就就的六级，疯了两天左右的样子，也学到了许多，了解到了初中小伙伴竟然现在都开始跟着导师进实验室写论文准备投SCI了，非常的鼓舞人心。

### CSAPP

这一周的末尾，我明白了一个道理，整本书是不能纯看书，且囫囵吞枣的想着尽快把整本书看完的。CMU的教授们还有**精心**布置的每一章的Lab来帮助我们进行巩固每一章的知识和基础吧，这些是需要完成的，所以我选择了回头看，回头看向第二章的内容，现在看起来第二章的内容反而没有刚开始那么反感了，知道这一章的内容是十分重要的。还有第一个**Data** **Lab**，等着我去揭开那些谜题，虽然有很多很多带着位操作的技巧性，但是学会了，也是区别于他人写程序的不同之处。亮点。所以，今天把第三章的学过的内容进行复习，包括上周没有写进来的 **控制部分**，总结完之后，后面的学习将会向后看，如果是做完了Data Lab还是感觉有去复习课程的必要，是需要的。第二章也只有三个学时。

#### 第三章 程序的机器级表示

**3.6 控制部分**

控制，就是要求指令进行有条件的执行，不是一条条的顺序执行。在机器代码中，提供了两种基本低级机制来实现有条件的行为。

**测试数据值**->根据结果来改变**控制流**与**数据流**。在这一小节中主要介绍了，实现条件操作（if else else if）的两种方式，循环，switch语句的用法，来讲述控制部分的机器代码表示。

**条件码和条件码寄存器**

* 首先一个重要的概念就是**条件码**。除了前面提到过的16个整数寄存器，**条件码寄存器**，条件码寄存器是作为最近的算术或逻辑操作的属性（即记录上一次操作的结果的属性）。条件码和条件码寄存器紧密相连。最常用的条件码；
  * **Zero Flag**: 最近得出的结果为零。类似地，**Overflow Flag**， **Carry Flag**， **Sign Flag**。分别表示最近的发生了溢出（正溢出\负溢出），**进位**，最近的操作得到了负数。
* 在这之前除了用来进行地址运算的**leaq**指令是进行地址计算，其他的所有的之前接触过的算术逻辑运算的指令，都会默认的在指令完成之后设置一个条件码。同时，除了算术逻辑运算的指令，还有着一些专职设置条件码的指令。**特点是:这些指令只是对条件码进行设置，而不改变仍和其他寄存器（只有读的权限）**。P136图3-13。 **CMP**，**TEST**。（比较和测试指令）。

条件码设置->**条件码的访问**

- 条件码的访问，有着专门的访问指令。条件码通常不会直接读取。采用三种方式进行使用：1.根据条件码的某种组合将**字节**设置为1，0。2.可以条件跳转到程序的某个其他的部分。3.可以有条件的传送数据。
- 实现以上的第一种使用方法的指令 **SET**，P137。注意：这一整类的SET指令，和算术逻辑运算不同，指令的后缀是为了表示的是满足的不同的条件（大于\等于）而不是对应操作的操作数大小。SET指令的目的操作数是单字节寄存器之一，或是单个字节的内存位置，是为了把这个字节设置为0或1 。通常模板指令，**执行比较指令，根据计算t=a-b设置条件码**，根据t的大小不同，和各种条件码的组合，如是否溢出和t与零的大小关系，综合起来就可以判断a和b的大小情况（就算发生了溢出）。SET（读取CMP设置的条件码）指令和CMP指令综合使用。

**跳转指令（jump）**P139 3- 15

- jmp指令，类比于go to 语句。jmp指令是无条件跳转，可以是直接跳转，也可以是间接跳转。需要区分的是：
  - 间接跳转：**jmp *%rax **,**jmp  *(%rax)**; 这两个都是间接跳转。写法*后面加一个操作数的指示符。间接跳转，实现了动态的提供跳转的地址。
  - 直接跳转：**jmp  .L1**,直接将地址写在了指令之中。
- 除了jmp指令无条件跳转，有条件跳转指令，后缀同SET指令，表示是满足的不同的条件。

**跳转指令的编码**

- 在汇编代码里，跳转目标是用符号标号进行书写，而在汇编器，连接器对代码进行处理的时候，就会产生相对应的跳转目标的合适的地址编码。最常见的编码方式：PC-relative。编码：**目标的地址和跳转指令后面那条指令的地址之间的差作为编码**，地址偏移量。还有直接给处出绝对地址的编码方式。
- 程序计数器中的值是跳转指令后面的那条指令的那条地址。

**用条件传送实现条件分支**

- 两种方式：控制的条件转移，数据的条件转移实现。

- if-else通用形式模板和汇编实现通常使用以下这种形式来描述if-else。

  ```c
  	t = test-expr;
  	if(!t)
  		goto false;
  	teh-statement
  	goto done;
  false:
  	esel-staement
  done:
  
  ```

  

 -	使用数据的条件转移，计算一个条件操作的两种结果。通过判断这个操作得到的结果的不同情况来进行条件跳转。
 -	p146 分支预测错误的处罚。
 -	总的来说，数据条件转移更加不吃性能，通过计算所有的可能性，在将所有的可能性进行判断之后做出条件选择跳转。

**循环**

- 循环：条件测试指令和跳转指令组合起来实现循环的效果。（就是嵌套的goto语句）。

- 通常对while循环两种翻译方法：**jump  to middle**, **guarded-to**.

  **jump to middle**

  ```c
  	goto test;
  loop:
  	body-statement
  test:
  	t = test-expr;
  	if(t):
  		goto loop;
  ```

  **guarded-to**

  ```c
  	t = test-expr;
  	if(!t)
  		goto done;
  loop:
  	t = test-expr
  	body-statement
  	if(t)
  		goto loop;
  done:
  ```

- 使用不同的编译器优化选项，会得到不同的翻译方法。

- 相应的，for循环转换成while循环实现。

**switch语句的实现**

- 重要的数据结构：**跳转表（jump table)**,跳转表是一个数组，其中表项保存着一个代码端的地址。使用跳转表的优点在于，执行时间和判断情况数量无关，跳转表的实现p160.



### 哈夫曼

这周感觉记忆最深刻的就是完成了数据结构的大作业，用哈夫曼树编码实现一个文本压缩软件。[数据结构大作业-202331081427.docx](2024春15周\数据结构大作业-202331081427.docx) 。













































